CREATE TABLE person (
	ID int,
	name varchar(70) NOT NULL,
	nickname varchar(70),
	email varchar(255) NOT NULL,
	password varchar(255) NOT NULL,
	PRIMARY KEY (ID),
);

CREATE TABLE address (
	ID int,
	line1 varchar(255) NOT NULL,
	line2 varchar(255),
	line3 varchar(255),
	city varchar(255) NOT NULL,
	county_province varchar(255) NOT NULL,
	zip char(5) NOT NULL,
	country varchar(255) NOT NULL,
	PRIMARY KEY (ID)
);

CREATE TABLE owns (
	user_id int,
	address_id int,
	PRIMARY KEY (user_id, address_id),
	FOREIGN KEY (user_id) REFERENCES (user.id),
	FOREIGN KEY (address_id) REFERENCES (address.id)
)

CREATE TABLE spot (
	ID int,
	name varchar (20) NOT NULL,
	description varchar(140),
	PRIMARY KEY (ID),
);

CREATE TABLE spawns (
	spot_id int,
	address_id int,
	PRIMARY KEY (spot_id, address_id)
	FOREIGN KEY (spot_id) REFERENCES (spot.id),
	FOREIGN KEY (address_id) REFERENCES (address.id)
);

CREATE TABLE instance (
	spot_id int,
	start TIMESTAMP NOT NULL,
	stop TIMESTAMP NOT NULL,
	hour_rate numeric(6, 2) NOT NULL,
	check (rate >= 0),
	check (stop > start),
	PRIMARY KEY (spot_id, start),
	FOREIGN KEY (spot_id) REFERENCES (spot.id)
);

CREATE TABLE transaction (
	ID int,
	user_id int,
	spot_id int,
	spot_start TIMESTAMP,
	start TIMESTAMP NOT NULL,
	stop TIMESTAMP NOT NULL,
	total_cost numeric(8, 2) NOT NULL,
	PRIMARY KEY (ID),
	FOREIGN KEY (user_id) REFERENCES (user.id),
	FOREIGN KEY (spot_id, spot_start) REFERENCES (spot.id, spot.start)
);


STILL WORKING ON
----------------

CREATE table payment (
	ID int,
	username varchar(255),
);

CREATE TABLE uses (
	user_id int,
	payment_id,
	PRIMARY KEY (user_id, payment_id),
	FOREIGN KEY (user_id) REFERENCES (user.id),
	FOREIGN KEY (payment_id) REFERENCES (payment.id);
);


